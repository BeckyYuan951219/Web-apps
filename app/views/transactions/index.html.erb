<h1>KelloggCoin Ledger</h1>

<!-- Step 1: List all transactions, starting with the ICO -->


<h2>Kellogg Coin Transactions</h2>



<table border="1">
  
  <tr>
    <th>Amount (KC)</th>
    <th>From (Sender)</th>
    <th>To (Receiver)</th>
  </tr>

  <% Transaction.all.each do |transaction| %>
    <% from_user = User.find_by({ "id" => transaction.from_user_id }) %>
    <% to_user = User.find_by({ "id" => transaction.to_user_id }) %>
    
    <tr>
      <td><%= transaction.amount %></td>
      
      <% if from_user %>
        <td><%= from_user.name %></td>
      <% else %>
        <td>Initial coin offering</td>
      <% end %>
      
      <td><%= to_user.name %></td>
    </tr>

  <% end %> </table>
<!-- Step 2: Calculate and display the balances -->
<h2>User Balances</h2>

<table border="1">
  
  <tr>
    <th>User Name</th>
    <th>Balance (KC)</th>
  </tr>

  <% User.all.each do |user| %>
    
    <% balance_in = Transaction.where({ "to_user_id" => user.id }).sum("amount") %>
    <% balance_out = Transaction.where({ "from_user_id" => user.id }).sum("amount") %>
    <% total_balance = balance_in - balance_out %>

    <tr>
      <td><%= user.name %></td>
      <td><%= total_balance %></td>
    </tr>

  <% end %> </table>
<!-- 
Expected balances:
Balance for Brian: 1348 KC
Balance for Ben: 2516 KC
Balance for Evan: 1164 KC
Balance for Anthony: 1456 KC
Balance for Krystina: 3516 KC 
-->

